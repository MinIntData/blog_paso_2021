---
title: "Mapa Apata"
output: 
  flexdashboard::flex_dashboard:
    orientation: rows
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE, error = FALSE)

library(flexdashboard)
library(tidyverse)
library(sf)
library(leaflet)

# Diputados x depto ####
base_diputados <- read_sf("../content/data/apatia/base_diputados_apatia.geojson") %>%
  print()

paleta_dip <- colorNumeric(palette = "viridis", domain = base_diputados$diferencia_apatia, reverse = T)

```

Row
-----------------------------------------------------------------------

### Mapa de apatía electoral por departamento

```{r}
leaflet(base_diputados) %>%
  addTiles() %>%
  addProviderTiles(providers$CartoDB.DarkMatter) %>%
  addPolygons(popup = ~paste("Provincia: ", base_diputados$id,
                             "</br>Departamento: ", nomdepto_censo,
                             "</br>Promedio histórico de participacion: ", as.character(promedio_participacion),
                             "</br>Participación 2021: ", as.character(participacion),
                             "</br>Prom. histórico apatía: ", as.character(promedio_apatia),
                             "</br>Apatía 2021 : ", as.character(apatia)),
              fillColor = ~paleta_dip(diferencia_apatia),
              weight = 0,
              fillOpacity = 0.9) %>%
  addPolylines(color = "white", weight = 0.6) %>%
  addLegend(pal = paleta_dip, values = base_diputados$diferencia_apatia,
            title = "Diferencia de apatía con respecto al promedio histórico",
            opacity = 0.1)
```

